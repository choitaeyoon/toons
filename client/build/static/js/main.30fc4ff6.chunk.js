(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{146:function(e,t,a){e.exports=a(326)},151:function(e,t,a){},269:function(e,t){},326:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(21),o=a.n(i),s=a(16),c=a(17),l=a(19),m=a(18),u=a(20),p=a(330),h=a(328),d=(a(86),a(151),a(31)),g=a(60),f=a.n(g),E=a(42),b=a.n(E),v=a(41),y=a.n(v),w=a(26),j=a.n(w),O=a(23),k=a.n(O),C=a(27),x=a.n(C),N=a(61),S=a.n(N),T=a(29),I=a.n(T),P=a(24),B=a.n(P),A=a(5),D=a.n(A),F=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target,n=t.value,r=t.name;a.setState(Object(d.a)({},r,n))},a.onSubmit=function(e){e.preventDefault(),fetch("https://api.toons.tae-yoon.me/api/user/authenticate",{method:"POST",credentials:"include",body:JSON.stringify(a.state),headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(function(e){if(200!==e.status)throw console.log(e.body),new Error(e.error);console.log("verified"),a.props.history.push("/")}).catch(function(e){console.log(e),alert("Email or Password Incorrect")})},a.state={email:"",password:""},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("main",{className:t.main},r.a.createElement(y.a,null),r.a.createElement(I.a,{className:t.paper},r.a.createElement(f.a,{className:t.avatar},r.a.createElement(S.a,null)),r.a.createElement(B.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:t.form,onSubmit:this.onSubmit},r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(x.a,{htmlFor:"email"},"Email Address"),r.a.createElement(k.a,{id:"email",name:"email",autoComplete:"email",value:this.state.email,onChange:this.handleInputChange})),r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(x.a,{htmlFor:"password"},"Password"),r.a.createElement(k.a,{id:"password",name:"password",type:"password",autoComplete:"current-password",value:this.state.password,onChange:this.handleInputChange})),r.a.createElement(b.a,{type:"submit",fullWidth:!0,variant:"contained",color:"secondary",className:t.submit},"Sign in")),r.a.createElement(b.a,{variant:"text",size:"small",type:"register",className:t.register,onClick:function(){return e.props.history.push("/register")}},"Register Now")))}}]),t}(r.a.Component),R=D()(function(e){return{html:{fontFamily:"roboto"},main:Object(d.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing.unit,marginBottom:2*e.spacing.unit},submit:{marginTop:3*e.spacing.unit},register:{marginTop:2*e.spacing.unit},facebook:{marginTop:3*e.spacing.unit}}})(F),W=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target,n=t.value,r=t.name;a.setState(Object(d.a)({},r,n))},a.onSubmit=function(e){e.preventDefault();var t=a.state;t.password!==t.confirmPassword?alert("Passwords don't match"):fetch("https://api.toons.tae-yoon.me/api/user/register",{method:"POST",body:JSON.stringify(a.state),headers:{"Content-Type":"application/json"}}).then(function(e){if(200===e.status)a.props.history.push("/signin");else{if(202!=e.status)throw new Error(e.error);alert("User already exists")}}).catch(function(e){console.log(e),alert("Error logging in")})},a.state={email:"",password:"",confirmPassword:"",nickname:""},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("main",{className:t.main},r.a.createElement(y.a,null),r.a.createElement(I.a,{className:t.paper},r.a.createElement(f.a,{className:t.avatar},r.a.createElement(S.a,null)),r.a.createElement(B.a,{component:"h1",variant:"h5"},"Register"),r.a.createElement("form",{className:t.form,onSubmit:this.onSubmit},r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(x.a,{htmlFor:"nickname"},"Nickname"),r.a.createElement(k.a,{id:"nickname",name:"nickname",autoComplete:"nickname",value:this.state.nickname,onChange:this.handleInputChange,autoFocus:!0})),r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(x.a,{htmlFor:"email"},"Email Address"),r.a.createElement(k.a,{id:"email",name:"email",autoComplete:"email",value:this.state.email,onChange:this.handleInputChange})),r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(x.a,{htmlFor:"password"},"Password"),r.a.createElement(k.a,{id:"password",name:"password",type:"password",value:this.state.password,onChange:this.handleInputChange})),r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(x.a,{htmlFor:"confirmPassword"},"Confirm Password"),r.a.createElement(k.a,{id:"confirmPassword",name:"confirmPassword",type:"password",value:this.state.confirmPassword,onChange:this.handleInputChange})),r.a.createElement(b.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit},"Register")),r.a.createElement(b.a,{variant:"text",size:"small",type:"signin",className:t.signin,onClick:function(){return e.props.history.push("/signin")}},"Already have an account? Click Here")))}}]),t}(r.a.Component),U=D()(function(e){return{main:Object(d.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit},signin:{marginTop:2*e.spacing.unit}}})(W),L=a(144),q=a(129),G=a.n(q),_=a(30),z=a(62),J=a.n(z),M=a(140),H=a.n(M),V=a(141),K=a.n(V),X=a(142),Y=a.n(X),Q=a(143),Z=a.n(Q),$=a(63),ee=a.n($),te=a(130),ae=a(6),ne=a.n(ae),re=a(131),ie=a.n(re),oe=a(132),se=a.n(oe),ce=a(133),le=a.n(ce),me=a(134),ue=a.n(me),pe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(ie.a,{position:"absolute",className:ne()(e.appBar)},r.a.createElement(se.a,{className:e.toolbar},r.a.createElement(B.a,{component:"h1",variant:"h5",color:"inherit",noWrap:!0,className:e.title},"Toons Room"),r.a.createElement(J.a,{color:"inherit"},r.a.createElement(le.a,{badgeContent:4,color:"secondary"},r.a.createElement(ue.a,null)))))}}]),t}(n.Component),he=Object(_.withStyles)(function(e){return{appBar:{zIndex:e.zIndex.drawer+1},toolbar:{paddingRight:24},toolbarIcon:Object(te.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),menuButton:{marginLeft:12,marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1}}})(pe),de=a(135),ge=a.n(de),fe=a(84),Ee=a.n(fe),be=a(136),ve=a.n(be),ye=a(137),we=a.n(ye),je=a(139),Oe=a.n(je),ke=a(138),Ce=a.n(ke),xe=function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).call(this,e))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(ge.a,{className:e.drawer,variant:"permanent",classes:{paper:e.drawerPaper}},r.a.createElement("div",{className:e.toolbar}),r.a.createElement(Ee.a,null,this.props.onlineUsers.map(function(e){return r.a.createElement(ve.a,{button:!0},r.a.createElement(we.a,null,r.a.createElement(Ce.a,null)),r.a.createElement(Oe.a,{primary:e.nickname}))})),r.a.createElement(ee.a,null))}}]),t}(n.Component),Ne=Object(_.withStyles)(function(e){return{drawer:{width:240,flexShrink:0},drawerPaper:{width:240},toolbar:{marginTop:10*e.spacing.unit}}})(xe),Se=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).scrollToBottom=function(){a.messagesEnd.scrollIntoView({behavior:"smooth"})},a.state={email:"",nickname:"",message:"",messages:[],onlineUsers:[]},a.socket=G()("https://api.toons.tae-yoon.me"),a.socket.on("connect",function(){fetch("https://api.toons.tae-yoon.me/api/user/userInfo",{credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(function(e){return e.json()}).then(function(e){n(e),a.socket.emit("NEW_CONNECTION",{nickname:e.nickname})})});var n=function(e){a.setState({nickname:e.nickname,email:e.email})};a.socket.on("ONLINE_USERS_UPDATE",function(e){r(e)});var r=function(e){a.setState({onlineUsers:e})};a.socket.on("RECEIVE_MESSAGE",function(e){i(e)});var i=function(e){a.setState({messages:[].concat(Object(L.a)(a.state.messages),[e])})};return a.textFieldEnter=function(e){"Enter"===e.key&&(e.preventDefault(),a.socket.emit("SEND_MESSAGE",{author:a.state.nickname,message:a.state.message}),a.setState({message:""}))},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{className:t.root},r.a.createElement(y.a,null),r.a.createElement(he,null),r.a.createElement(Ne,{onlineUsers:this.state.onlineUsers}),r.a.createElement("main",{className:t.content},r.a.createElement("div",{className:t.appBarSpacer}),r.a.createElement("div",{className:t.tableContainer},r.a.createElement(H.a,{className:t.chatBox},r.a.createElement(K.a,{className:t.chatLog},this.state.messages.map(function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:t.author},r.a.createElement(B.a,{component:"h1",variant:"h6",color:"secondary"},e.author)),r.a.createElement("div",{className:t.message},r.a.createElement(B.a,{component:"h1",variant:"body1"},e.message)),r.a.createElement(ee.a,{className:t.divider,variant:"middle",light:"true"}))}),r.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(t){e.messagesEnd=t}})),r.a.createElement("cardActions",{className:t.actions,disableActionSpacing:!0},r.a.createElement(Y.a,{className:t.textfield,variant:"filled",multiline:"true",value:this.state.message,onChange:function(t){return e.setState({message:t.target.value})},onKeyPress:this.textFieldEnter}),r.a.createElement(J.a,{"aria-label":"more",className:t.actionsIcons},r.a.createElement(Z.a,null)))))))}}]),t}(n.Component),Te=Object(_.withStyles)(function(e){return{html:{fontFamily:"roboto"},root:{display:"flex"},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,padding:3*e.spacing.unit,height:"100vh",overflow:"auto"},tableContainer:{height:"90%",display:"flex"},chatBox:{display:"flex",flexDirection:"column",flexGrow:1},chatLog:{height:"90%",width:"100%",margin:"auto",overflowY:"scroll",overflowX:"hidden"},actions:{display:"flex",flexDirection:"row"},textfield:{flexGrow:10},divider:{margin:"10px"}}})(Se),Ie=a(329);var Pe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"container"},r.a.createElement(h.a,{exact:!0,path:"/",component:(e=Te,function(t){function a(){var e;return Object(s.a)(this,a),(e=Object(l.a)(this,Object(m.a)(a).call(this))).state={loading:!0,redirect:!1},e}return Object(u.a)(a,t),Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("https://api.toons.tae-yoon.me/api/checkToken",{credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(function(t){if(200!==t.status)throw new Error(t.error);e.setState({loading:!1})}).catch(function(t){console.error(t),e.setState({loading:!1,redirect:!0})})}},{key:"render",value:function(){var t=this.state,a=t.loading,n=t.redirect;return a?null:n?r.a.createElement(Ie.a,{to:"/signin"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(e,this.props))}}]),a}(n.Component))}),r.a.createElement(h.a,{exact:!0,path:"/signin",component:R}),r.a.createElement(h.a,{exact:!0,path:"/register",component:U}))));var e}}]),t}(n.Component);o.a.render(r.a.createElement(Pe,null),document.getElementById("root"))}},[[146,1,2]]]);
//# sourceMappingURL=main.30fc4ff6.chunk.js.map